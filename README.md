# Wafer-to-Wafer Bonding CSAM Prediction Project

This project demonstrates an end-to-end workflow to predict CSAM images (indicating non-bond regions) based on bond wave data collected during wafer-to-wafer bonding. The project consists of three main modules:
- **Simulation Data Generation**
- **Model Training**
- **Model Inference (Prediction)**

## Directory Structure

```
.
├── simulate_data.py       # Generates simulated bond wave data and CSAM images (CSV and PNG formats)
├── train_model.py         # Loads CSV/PNG data, trains the model, and saves the trained model (trained_model.h5)
├── infer_model.py         # Loads bond wave CSV data and uses the trained model to predict CSAM images
├── bond_wave_data/        # Contains CSV files generated by simulate_data.py (each file is a 52x1000 matrix)
├── csam_images/           # Contains PNG images generated by simulate_data.py (each image is 256x256 in grayscale)
└── input_bond_wave/       # Folder for input bond wave CSV files used by infer_model.py (replace with your real data)
```

## Dependencies & Installation

This project is built with Python 3.x and relies on the following libraries:
- numpy
- pandas
- matplotlib
- tensorflow (>=2.x)
- Pillow

You can install the dependencies using pip:
```bash
pip install numpy pandas matplotlib tensorflow pillow
```

## Usage

### 1. Generate Simulated Data

Run the `simulate_data.py` script to generate simulated bond wave data and corresponding CSAM images. The generated data will be saved as follows:
- **bond_wave_data/**: Each sample is saved as a CSV file containing a 52×1000 matrix (each row represents a sensor).
- **csam_images/**: Each sample is saved as a PNG image with a size of 256×256 (grayscale, where 0 indicates normal bonding and 1 indicates non-bond defects).

Run the command:
```bash
python simulate_data.py
```

### 2. Train the Model

Run the `train_model.py` script to load the simulated data (in CSV/PNG formats), build and train a simple fully-connected neural network model. Once training is complete, the model will be saved as `trained_model.h5`.

Run the command:
```bash
python train_model.py
```

Feel free to modify the training parameters (e.g., number of epochs, batch size) and the model architecture as needed.

### 3. Model Inference

Place the bond wave CSV file you want to predict into the **input_bond_wave/** folder (format requirement: a 52×1000 matrix). Run the `infer_model.py` script. The script will:
- Load the first CSV file from the **input_bond_wave/** folder as input.
- Use the trained model to predict the corresponding CSAM image.
- Display both the input bond wave data and the predicted CSAM image.

Run the command:
```bash
python infer_model.py
```

## Customization

- **Data Replacement**:  
  When you have real data, simply replace the simulated data with your actual CSV files for bond wave data and PNG files for CSAM images. Alternatively, modify the data loading section in the scripts to suit your data format.

- **Model Adjustments**:  
  The model provided in this project is a basic example. Depending on the characteristics of your real data, you can adjust the model architecture, modify hyperparameters, or experiment with more advanced networks (e.g., convolutional networks or encoder-decoder structures).

## Model Architecture

The model constructed in `train_model.py` follows these steps:
1. The 52×1000 input data is flattened.
2. The flattened vector is passed through several fully-connected layers with dropout layers to prevent overfitting.
3. The final output is a vector corresponding to a 256×256 image, which is then reshaped into image form and passed through a Sigmoid activation to ensure the output is in the [0,1] range.

This model serves as a preliminary demonstration of the mapping relationship and can be further optimized based on performance.

## License

This project is intended for educational and research purposes only. Feel free to modify and extend it as needed.